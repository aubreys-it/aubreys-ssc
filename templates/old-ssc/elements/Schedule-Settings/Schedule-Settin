<link rel="import" href="../../bower_components/polymer/polymer.html">
<dom-module id="Schedule-Settings">

<template >

<hr>
<div style="z-index:20;position:fixed; bottom:5%;right:5%;">
<paper-fab success  icon="save" elevation="3" on-click="Update"></paper-fab>
<paper-tooltip position="left">Save changes.</paper-tooltip>
</div>

		<h2>Day Settings:</h2>
		<template is="dom-repeat" items="{{Settings}}"   id="EmployeeTemplate">
			<paper-card class="" elevation="1" onfocusin="hoverOver(this)"  onfocusout="hoverOut(this)" style="margin-top:10px;margin-left:10px;" secondary>
	            <div class="card-content">
	            	<h3 id="Day-Name-{{index}}">{{item.DayName}}</h3>

	            	<!--Begin AM Settings-->

                    <hr>

					<iron-label>
   						<span>AM Must Calls Needed:</span>
						<paper-radio-group id="MC-AM-{{index}}" selected="{{item.AM_MCs}}">
							<paper-radio-button name="0">0</paper-radio-button>
	  						<paper-radio-button name="1">1</paper-radio-button>
	  						<paper-radio-button name="2">2</paper-radio-button>
						</paper-radio-group>
					</iron-label>
                    <paper-input name="AM_Open_Shifts" label="AM Open Shifts" value="{{item.AM_Open_Shifts}}"></paper-input>
                    <paper-input name="AM_ToGo" label="AM ToGo" value="{{item.AM_ToGo}}"></paper-input>
                    <paper-input name="AM_Bar" label="AM Bar" value="{{item.AM_Bar}}"></paper-input>
                    </br>
					<!--Begin PM Settings-->




					<iron-label>
   						<span>PM Must Calls Needed:</span>
						<paper-radio-group id="MC-PM-{{index}}" selected="{{item.PM_MCs}}">
							<paper-radio-button name="0">0</paper-radio-button>
	  						<paper-radio-button name="1">1</paper-radio-button>
	  						<paper-radio-button name="2">2</paper-radio-button>
						</paper-radio-group>
					</iron-label>
					<paper-input name="PM_Open_Shifts" label="PM Open Shifts" value="{{item.PM_Open_Shifts}}"></paper-input>
                    <paper-input name="PM_ToGo" label="PM ToGo" value="{{item.PM_ToGo}}"></paper-input>
                    <paper-input name="PM_Bar_1" label="PM Bar 1" value="{{item.PM_Bar_1}}"></paper-input>
                    <paper-input name="PM_Bar_2" label="PM Bar 2" value="{{item.PM_Bar_2}}"></paper-input>
				</div>
			</paper-card>
		</template>

		<div style="height:50px;">
		<!-- <paper-fab success style="float:right; " icon="save" elevation="3" on-click="Update"></paper-fab> -->
	</div>


	 <iron-ajax
	   id="ajax"
	   handle-as="json"
	   method="get"
	   url="../../php/JSON_Settings.php"
	   last-response="{{Settings}}"
	   on-response="LoadingComplete"
	   content-type="application/json">
	</iron-ajax>
	<iron-ajax
		id="postAjax"
		handle-as="json"
		method="get"
		on-response="postComplete"
		url="../../php/JSON_Settings.php">
	</iron-ajax>
</template>



<script>
hoverOver = function(srcElement) {
		srcElement.elevation = 3;
};

hoverOut = function(srcElement) {
	 srcElement.elevation = 1;
};

Polymer({
  is: 'Schedule-Settings',


   ready: function(){
   	this.async(function(){
  	this.$.ajax.params = {"Request":"GET"};
  	this.$.ajax.generateRequest();
  	},400);
  },

  Update: function(){

  	var data = {};
  	for (i = 0; i < this.Settings.length; i++){
  		data[i] = {}
  		data[i]["DayName"] = this.Settings[i]["DayName"];
  		data[i]["AM_Open_Shifts"] = this.Settings[i]["AM_Open_Shifts"];
  		data[i]["AM_Bar"] = this.Settings[i]["AM_Bar"];
  		data[i]["AM_ToGo"] = this.Settings[i]["AM_ToGo"]
  		data[i]["MCAM"] = this.Settings[i]["AM_MCs"];
  		data[i]["PM_Open_Shifts"] = this.Settings[i]["PM_Open_Shifts"];
  		data[i]["PM_Bar_1"] = this.Settings[i]["PM_Bar_1"];
  		data[i]["PM_Bar_2"] = this.Settings[i]["PM_Bar_2"];
  		data[i]["PM_ToGo"] = this.Settings[i]["PM_ToGo"];
  		data[i]["MCPM"] = this.Settings[i]["PM_MCs"];
  	};
  	JSONdata = JSON.stringify(data);
  	this.$.postAjax.params = {"Request":"UPDATE", "Data":JSONdata};
  	app.$.toast.text = "Settings Updated.";
  	this.$.postAjax.generateRequest();

  },

  postComplete: function(){
  	app.$.toast.show();
  },
   LoadingComplete: function(){
        app.PageLoading=false;
      }

});
</script>
</dom-module>
